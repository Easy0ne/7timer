!function(){"use strict";function m(a){return a.valueOf()/j-.5+k}function n(a){return new Date((a+.5-k)*j)}function o(a){return m(a)-l}function q(a,e){return f(b(a)*c(p)-d(e)*b(p),c(a))}function r(a,d){return e(b(d)*c(p)+c(d)*b(p)*b(a))}function s(a,e,g){return f(b(a),c(a)*b(e)-d(g)*c(e))}function t(a,d,f){return e(b(d)*b(f)+c(d)*c(f)*c(a))}function u(a,b){return i*(280.16+360.9856235*a)-b}function v(a){return 0>a&&(a=0),2967e-7/Math.tan(a+.00312536/(a+.08901179))}function w(a){return i*(357.5291+.98560028*a)}function x(c){var d=i*(1.9148*b(c)+.02*b(2*c)+3e-4*b(3*c)),e=102.9372*i;return c+d+e+a}function y(a){var b=w(a),c=x(b);return{dec:r(c,0),ra:q(c,0)}}function C(b,c){return Math.round(b-B-c/(2*a))}function D(b,c,d){return B+(b+c)/(2*a)+d}function E(a,c,d){return l+a+.0053*b(c)-.0069*b(2*d)}function F(a,d,e){return g((b(a)-b(d)*b(e))/(c(d)*c(e)))}function G(a,b,c,d,e,f,g){var h=F(a,c,d),i=D(h,b,e);return E(i,f,g)}function H(a){var d=i*(218.316+13.176396*a),e=i*(134.963+13.064993*a),f=i*(93.272+13.22935*a),g=d+6.289*i*b(e),h=5.128*i*b(f),j=385001-20905*c(e);return{ra:q(g,h),dec:r(g,h),dist:j}}function I(a,b){return new Date(a.valueOf()+b*j/24)}var A,B,a=Math.PI,b=Math.sin,c=Math.cos,d=Math.tan,e=Math.asin,f=Math.atan2,g=Math.acos,i=a/180,j=864e5,k=2440588,l=2451545,p=23.4397*i,z={};z.getPosition=function(a,b,c){var d=i*-c,e=i*b,f=o(a),g=y(f),h=u(f,d)-g.ra;return{azimuth:s(h,e,g.dec),altitude:t(h,e,g.dec)}},A=z.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]],z.addTime=function(a,b,c){A.push([a,b,c])},B=9e-4,z.getTimes=function(a,b,c){var p,q,s,t,u,d=i*-c,e=i*b,f=o(a),g=C(f,d),h=D(0,d,g),j=w(h),k=x(j),l=r(k,0),m=E(h,j,k),v={solarNoon:n(m),nadir:n(m-.5)};for(p=0,q=A.length;q>p;p+=1)s=A[p],t=G(s[0]*i,d,e,l,g,j,k),u=m-(t-m),v[s[1]]=n(u),v[s[2]]=n(t);return v},z.getMoonPosition=function(a,e,g){var h=i*-g,j=i*e,k=o(a),l=H(k),m=u(k,h)-l.ra,n=t(m,j,l.dec),p=f(b(m),d(j)*c(l.dec)-b(l.dec)*c(m));return n+=v(n),{azimuth:s(m,j,l.dec),altitude:n,distance:l.dist,parallacticAngle:p}},z.getMoonIllumination=function(a){var d=o(a),e=y(d),h=H(d),i=149598e3,j=g(b(e.dec)*b(h.dec)+c(e.dec)*c(h.dec)*c(e.ra-h.ra)),k=f(i*b(j),h.dist-i*c(j)),l=f(c(e.dec)*b(e.ra-h.ra),b(e.dec)*c(h.dec)-c(e.dec)*b(h.dec)*c(e.ra-h.ra));return{fraction:(1+c(k))/2,phase:.5+.5*k*(0>l?-1:1)/Math.PI,angle:l}},z.getMoonTimes=function(a,b,c,d){var h,j,k,l,m,n,o,p,q,r,s,t,u,f,g,v,w,e=new Date(a);for(d?e.setUTCHours(0,0,0,0):e.setHours(0,0,0,0),f=.133*i,g=z.getMoonPosition(e,b,c).altitude-f,v=1;24>=v&&(h=z.getMoonPosition(I(e,v),b,c).altitude-f,j=z.getMoonPosition(I(e,v+1),b,c).altitude-f,m=(g+j)/2-h,n=(j-g)/2,o=-n/(2*m),p=(m*o+n)*o+h,q=n*n-4*m*h,r=0,q>=0&&(u=Math.sqrt(q)/(2*Math.abs(m)),s=o-u,t=o+u,Math.abs(s)<=1&&r++,Math.abs(t)<=1&&r++,-1>s&&(s=t)),1===r?0>g?k=v+s:l=v+s:2===r&&(k=v+(0>p?t:s),l=v+(0>p?s:t)),!k||!l);v+=2)g=j;return w={},k&&(w.rise=I(e,k)),l&&(w.set=I(e,l)),k||l||(w[p>0?"alwaysUp":"alwaysDown"]=!0),w},z.getGalaxyPosition=function(a,b,c){var d=i*-c,e=i*b,f=o(a),g={dec:-28.9333333*i,ra:266.5*i},j=u(f,d)-g.ra;return h=t(j,e,g.dec),h+=v(h),{azimuth:s(j,e,g.dec),altitude:h}},z.getGalaxyTimes=function(a,b,c,d){var h,k,l,m,n,o,p,q,r,s,t,u,v,f,g,w,x,e=new Date(a);for(d?e.setUTCHours(0,0,0,0):e.setHours(0,0,0,0),f=.133*i,g=z.getGalaxyPosition(e,b,c).altitude-f,w=1;24>=w&&(h=z.getGalaxyPosition(I(e,w),b,c).altitude-f,k=z.getGalaxyPosition(I(e,w+1),b,c).altitude-f,n=(g+k)/2-h,o=(k-g)/2,p=-o/(2*n),q=(n*p+o)*p+h,r=o*o-4*n*h,s=0,r>=0&&(v=Math.sqrt(r)/(2*Math.abs(n)),t=p-v,u=p+v,Math.abs(t)<=1&&s++,Math.abs(u)<=1&&s++,-1>t&&(t=u)),1===s?0>g?l=w+t:m=w+t:2===s&&(l=w+(0>q?u:t),m=w+(0>q?t:u)),!l||!m);w+=2)g=k;return x={},l&&(x.rise=I(e,l)),m&&(x.set=I(e,m)),l&&m&&(m>l?x.mid=I(e,(l+m)/2):(x.mid=I(e,(l+m+j)/2),x.set=I(e,m+j))),l||m||(x[q>0?"alwaysUp":"alwaysDown"]=!0),x},"function"==typeof define&&define.amd?define(z):"undefined"!=typeof module?module.exports=z:window.SunCalc=z}();